# Project Structure: Correct vs Incorrect

## âœ… CORRECT Structure (Tuist Files at Root)

```
listen-anonymously/                    â† Repository root
â”‚
â”œâ”€â”€ .git/                              â† Git directory
â”œâ”€â”€ .gitignore                         â† Git ignore file
â”‚
â”œâ”€â”€ ğŸ”§ Tuist Configuration Files (ROOT LEVEL)
â”œâ”€â”€ .mise.toml                         âœ… Tool versions (mise)
â”œâ”€â”€ Project.swift                      âœ… Tuist project definition
â”œâ”€â”€ Package.swift                      âœ… SPM dependencies
â”œâ”€â”€ Config.swift                       âœ… Tuist configuration
â”‚
â”œâ”€â”€ ğŸš Setup Scripts (ROOT LEVEL)
â”œâ”€â”€ setup-tuist.fish                   âœ… Fish setup script
â”œâ”€â”€ setup-tuist.sh                     âœ… Bash setup script
â”‚
â”œâ”€â”€ âš™ï¸ Build Configuration (ROOT LEVEL)
â”œâ”€â”€ Debug.xcconfig                     âœ… Debug build settings
â”œâ”€â”€ Release.xcconfig                   âœ… Release build settings
â”œâ”€â”€ Secrets.xcconfig                   âœ… Local secrets (git-ignored)
â”œâ”€â”€ Secrets.xcconfig.example           âœ… Secret template
â”‚
â”œâ”€â”€ ğŸ“š Documentation (ROOT LEVEL)
â”œâ”€â”€ README.md
â”œâ”€â”€ FISH_SHELL_GUIDE.md
â”œâ”€â”€ FISH_MISE_SUMMARY.md
â”œâ”€â”€ TUIST_SETUP.md
â”œâ”€â”€ PROJECT_STRUCTURE.md
â”œâ”€â”€ (other docs...)
â”‚
â”œâ”€â”€ ğŸ“± Source Code (SUBDIRECTORIES)
â”œâ”€â”€ Listen anonymously/
â”‚   â”œâ”€â”€ Sources/
â”‚   â”‚   â”œâ”€â”€ AppDelegate.swift
â”‚   â”‚   â”œâ”€â”€ Views/
â”‚   â”‚   â””â”€â”€ ViewModels/
â”‚   â””â”€â”€ Resources/
â”‚       â”œâ”€â”€ Assets.xcassets
â”‚       â””â”€â”€ Info.plist
â”‚
â”œâ”€â”€ Listen anonymously Ext/
â”‚   â”œâ”€â”€ Sources/
â”‚   â”‚   â””â”€â”€ ActionViewController.swift
â”‚   â””â”€â”€ Resources/
â”‚       â”œâ”€â”€ MainInterface.storyboard
â”‚       â””â”€â”€ Info.plist
â”‚
â”œâ”€â”€ Listen Anonymously Shared/
â”‚   â”œâ”€â”€ Sources/
â”‚   â”‚   â”œâ”€â”€ Models/
â”‚   â”‚   â”œâ”€â”€ Services/
â”‚   â”‚   â””â”€â”€ Views/
â”‚   â””â”€â”€ Resources/
â”‚
â”œâ”€â”€ ğŸ§ª Test Directories (SUBDIRECTORIES)
â”œâ”€â”€ Listen anonymously Tests/
â”œâ”€â”€ Listen Anonymously Shared Tests/
â”œâ”€â”€ Listen anonymously Ext Tests/
â”‚
â”œâ”€â”€ ğŸš« Generated Files (NOT COMMITTED - in .gitignore)
â”œâ”€â”€ Listen anonymously.xcodeproj/      ğŸš« Generated by tuist generate
â”œâ”€â”€ Listen anonymously.xcworkspace/    ğŸš« Generated by tuist generate
â”œâ”€â”€ .tuist/                            ğŸš« Tuist cache
â”œâ”€â”€ Tuist/Dependencies/                ğŸš« Downloaded SPM packages
â”œâ”€â”€ DerivedData/                       ğŸš« Build artifacts
â””â”€â”€ .DS_Store                          ğŸš« macOS file
```

---

## âŒ INCORRECT Structure (Tuist Files Inside .xcodeproj)

```
listen-anonymously/                    â† Repository root
â”‚
â”œâ”€â”€ Listen anonymously.xcodeproj/      âš ï¸ Should NOT be committed
â”‚   â”œâ”€â”€ project.pbxproj                âŒ Old Xcode project (should be deleted)
â”‚   â”œâ”€â”€ Project.swift                  âŒ WRONG LOCATION!
â”‚   â”œâ”€â”€ Package.swift                  âŒ WRONG LOCATION!
â”‚   â”œâ”€â”€ Config.swift                   âŒ WRONG LOCATION!
â”‚   â””â”€â”€ .mise.toml                     âŒ WRONG LOCATION!
â”‚
â”œâ”€â”€ Debug.xcconfig                     âœ… Correct location
â”œâ”€â”€ Release.xcconfig                   âœ… Correct location
â””â”€â”€ (other files...)
```

**Problem:** If Tuist files are inside `.xcodeproj`, they won't work correctly!

---

## Why Tuist Files Must Be at Root

### 1. Tuist Expects Files at Repository Root

When you run `tuist generate`, it looks for:
- `Project.swift` in current directory
- `Package.swift` in current directory  
- `Config.swift` in current directory
- `.mise.toml` in current directory

If these are inside `.xcodeproj`, Tuist won't find them!

### 2. The .xcodeproj is Generated, Not Source

```
BEFORE Tuist:
- .xcodeproj is source (committed to git)
- Contains project.pbxproj (binary file)

AFTER Tuist:
- Project.swift is source (committed to git)
- .xcodeproj is generated (NOT committed)
```

### 3. Workflow Comparison

**Old Way (Without Tuist):**
```
Git Repo
â””â”€â”€ Listen anonymously.xcodeproj/
    â””â”€â”€ project.pbxproj            â† This is the source
        â†“
    Open in Xcode
```

**New Way (With Tuist):**
```
Git Repo
â”œâ”€â”€ Project.swift                  â† This is the source
â”œâ”€â”€ Package.swift
â””â”€â”€ Config.swift
    â†“
  tuist generate                   â† Generates .xcodeproj
    â†“
Listen anonymously.xcodeproj/
â””â”€â”€ project.pbxproj                â† Generated, not committed
    â†“
  Open in Xcode
```

---

## How to Fix Incorrect Structure

If your Tuist files are inside `.xcodeproj`:

### Step 1: Move Files to Root

```fish
# Fish shell commands
cd ~/path/to/listen-anonymously

# Move Tuist files from .xcodeproj to root
mv "Listen anonymously.xcodeproj/Project.swift" ./
mv "Listen anonymously.xcodeproj/Package.swift" ./
mv "Listen anonymously.xcodeproj/Config.swift" ./
mv "Listen anonymously.xcodeproj/.mise.toml" ./

# Also move setup scripts if they're in wrong place
mv "Listen anonymously.xcodeproj/setup-tuist.fish" ./
mv "Listen anonymously.xcodeproj/setup-tuist.sh" ./
```

### Step 2: Verify Structure

```fish
# Check files are at root
ls -la | grep -E "(Project.swift|Package.swift|Config.swift|.mise.toml)"

# Should output:
# Project.swift
# Package.swift
# Config.swift
# .mise.toml
```

### Step 3: Remove Old .xcodeproj (if it exists)

```fish
# IMPORTANT: Only do this after verifying Tuist files are at root!

# Backup first (optional)
mv "Listen anonymously.xcodeproj" "Listen anonymously.xcodeproj.backup"

# Or delete if you're confident
rm -rf "Listen anonymously.xcodeproj"
```

### Step 4: Generate New Project

```fish
# Install dependencies
tuist install

# Generate fresh .xcodeproj from Project.swift
tuist generate

# This creates a new .xcodeproj at root level
```

### Step 5: Verify Generated Structure

```fish
# Check that .xcodeproj now exists (generated)
ls -la | grep xcodeproj
# Should show: Listen anonymously.xcodeproj/

# Check it's NOT in git
git status | grep xcodeproj
# Should show nothing (because it's in .gitignore)
```

---

## Visual Comparison

### âŒ Before (Incorrect)

```
Repository Root
â”‚
â””â”€â”€ Listen anonymously.xcodeproj/     â† All files inside here
    â”œâ”€â”€ project.pbxproj               â† Old project file
    â”œâ”€â”€ Project.swift                 â† Should be at root!
    â”œâ”€â”€ Package.swift                 â† Should be at root!
    â””â”€â”€ Config.swift                  â† Should be at root!
```

**Problem:** `tuist generate` looks at root, won't find files!

### âœ… After (Correct)

```
Repository Root
â”œâ”€â”€ Project.swift                     â† At root (source, committed)
â”œâ”€â”€ Package.swift                     â† At root (source, committed)
â”œâ”€â”€ Config.swift                      â† At root (source, committed)
â”œâ”€â”€ .mise.toml                        â† At root (source, committed)
â”‚
â””â”€â”€ Listen anonymously.xcodeproj/     â† Generated (not committed)
    â””â”€â”€ project.pbxproj               â† Generated from Project.swift
```

**Correct:** Tuist finds files at root, generates project!

---

## Git Status Check

### What Git Should See (Correct)

```fish
git status
```

**Should show (if files are at root and .gitignore is correct):**

```
On branch main
Your branch is up to date with 'origin/main'.

Changes to be committed:
  new file:   .mise.toml
  new file:   Config.swift
  new file:   FISH_SHELL_GUIDE.md
  new file:   FISH_MISE_SUMMARY.md
  new file:   Package.swift
  new file:   Project.swift
  new file:   setup-tuist.fish
  modified:   .gitignore

Untracked files not shown (xcodeproj, xcworkspace are ignored)
```

**Should NOT show:**
- `Listen anonymously.xcodeproj/` (should be ignored)
- `Listen anonymously.xcworkspace/` (should be ignored)
- Any Tuist files inside `.xcodeproj`

### What Git Would See (Incorrect)

```
On branch main

Untracked files:
  Listen anonymously.xcodeproj/Project.swift
  Listen anonymously.xcodeproj/Package.swift
  Listen anonymously.xcodeproj/Config.swift
```

**Problem:** Tuist files are in wrong location!

---

## .gitignore Check

Your `.gitignore` should contain:

```gitignore
# Tuist - Generated Xcode Project Files
*.xcodeproj
*.xcworkspace
.tuist
Tuist/Dependencies
Derived/

# Secrets Configuration
Secrets.xcconfig
```

This ensures:
- âœ… Project.swift IS committed (source of truth)
- âœ… Package.swift IS committed (dependencies)
- âœ… Config.swift IS committed (Tuist settings)
- âœ… .mise.toml IS committed (tool versions)
- ğŸš« .xcodeproj is NOT committed (generated)
- ğŸš« .xcworkspace is NOT committed (generated)
- ğŸš« Secrets.xcconfig is NOT committed (contains actual secrets)

---

## Testing Your Structure

### Quick Verification Script (Fish)

```fish
#!/usr/bin/env fish

echo "Checking project structure..."
echo ""

set -l errors 0

# Check files are at root
for file in Project.swift Package.swift Config.swift .mise.toml
    if test -f $file
        echo "âœ… $file found at root"
    else
        echo "âŒ $file NOT found at root"
        set errors (math $errors + 1)
    end
end

echo ""

# Check files are NOT in .xcodeproj
if test -d "Listen anonymously.xcodeproj"
    for file in Project.swift Package.swift Config.swift .mise.toml
        if test -f "Listen anonymously.xcodeproj/$file"
            echo "âš ï¸  $file found in .xcodeproj (should be at root!)"
            set errors (math $errors + 1)
        end
    end
end

echo ""

# Check .xcodeproj is NOT tracked by git
if git ls-files | grep -q xcodeproj
    echo "âš ï¸  .xcodeproj is tracked by git (should be ignored!)"
    set errors (math $errors + 1)
else
    echo "âœ… .xcodeproj is properly ignored by git"
end

echo ""

if test $errors -eq 0
    echo "âœ… Project structure is CORRECT!"
    exit 0
else
    echo "âŒ Found $errors issue(s) in project structure"
    exit 1
end
```

Save as `check-structure.fish` and run:

```fish
chmod +x check-structure.fish
./check-structure.fish
```

---

## Summary

### âœ… Correct Structure

```
Tuist Files â†’ Root Directory â†’ Committed to Git
Generated .xcodeproj â†’ Root Directory â†’ Ignored by Git
Source Code â†’ Subdirectories â†’ Committed to Git
```

### âŒ Incorrect Structure

```
Tuist Files â†’ Inside .xcodeproj â†’ Won't Work!
```

### Commands to Verify

```fish
# Check files at root
ls -1 | grep -E "(Project|Package|Config|mise)"

# Should output:
# Config.swift
# Package.swift
# Project.swift
# .mise.toml

# Check .xcodeproj is ignored
git status | grep xcodeproj

# Should output nothing (it's ignored)
```

### If Structure is Wrong

1. Move Tuist files to root
2. Delete old .xcodeproj
3. Run `tuist generate`
4. Verify git status shows files at root
5. Verify .xcodeproj is ignored

---

**Remember:** With Tuist, `Project.swift` is the source, `.xcodeproj` is generated!
